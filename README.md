

# 4stIT
> ### Team - 3dasu



<br>

## 👨‍👩‍👧‍👦 팀원

[장현준]|[김은경]|[이유진]|[이지정]|[정수진]|[최규범]|
------|------|------|------------------|--------------------|------|
 |  |  | 
 |  |  | 

<br>

## 🗂️ 프로젝트 소개
<br>

<div>
  
  **IT 뉴스 추천 및 검색 서비스**인 4stIT은 <br>
사용자의 관심사에 맞는 뉴스 정보를 제공하고, 검색할 수 있는 **뉴스 서비스**입니다.<br>
다양한 종류의 IT 정보를 개인이 전부 파악하기에는 많은 시간이 소요되는 어려움이 있습니다.<br>
이러한 어려움을 해소하고, 사용자의 **정보 접근성 향상**에 기여하고자 4stIT 서비스를 개발하게 되었습니다.<br>

따라서 4stIT은 다음과 같은 **기대효과**를 가지고 있습니다.

1. **사용자 니즈에 맞는 정보 제공**<br>
    사용자의 관심사를 기반으로 관련 뉴스를 추천, 사용자 니즈에 맞는 정보를 제공할 수 있습니다.
2. **사용자의 정보 접근성 향상**<br>
    4stIT이라는 통합된 하나의 서비스를 통해 다양한 주제의 뉴스에 접근할 수 있으며, 검색 기능을 통해 원하는 주제의 뉴스에 접근할 수 있습니다.
    
즉, 4stIT을 통해 사용자들은 편리하게 원하는 IT정보에 접근할 수 있습니다.

</div>

<br>

## ✨ CI/CD 필요성

1. **개발 속도 및 효율성 향상**<br>
- 반복 작업을 자동화하여 개발자들이 핵심 기능에 집중할 수 있게 만듦<br>
2. **품질 및 안정성 개선**<br>
- 지속적인 통합과 테스트를 통해 코드 품질 보장 및 안정성 확보<br>
3. **협업 효율성 증가**<br>
- 프론트엔드와 백엔드 각각에 맞춘 파이프라인을 통해 병렬 작업 가능

<br>

## ⚙개발 환경
### [DevOps]
![Docker](https://img.shields.io/badge/docker-%230db7ed.svg?style=for-the-badge&logo=docker&logoColor=white) ![Kubernetes](https://img.shields.io/badge/kubernetes-%23326ce5.svg?style=for-the-badge&logo=kubernetes&logoColor=white) ![Jenkins](https://img.shields.io/badge/jenkins-%232C5263.svg?style=for-the-badge&logo=jenkins&logoColor=white)

### [ FrontEnd ]
<img src="https://img.shields.io/badge/javascript-F7DF1E?style=for-the-badge&logo=javascript&logoColor=black"> <img src="https://img.shields.io/badge/html5-E34F26?style=for-the-badge&logo=html&logoColor=white"> <img src="https://img.shields.io/badge/css-1572B6?style=for-the-badge&logo=css3&logoColor=white"> <img src="https://img.shields.io/badge/vue.js-4FC08D?style=for-the-badge&logo=vue.js&logoColor=white"> <img src="https://img.shields.io/badge/bootstrap-7952B3?style=for-the-badge&logo=bootstrap&logoColor=white"><br>
![Vite](https://img.shields.io/badge/vite-%23646CFF.svg?style=for-the-badge&logo=vite&logoColor=white) ![NPM](https://img.shields.io/badge/NPM-%23CB3837.svg?style=for-the-badge&logo=npm&logoColor=white)

### [ BackEnd ]
<img alt="Java" src="https://img.shields.io/badge/Java-ED8B00?style=for-the-badge&logo=openjdk&logoColor=white"/> <img src="https://img.shields.io/badge/gradle-02303A?style=for-the-badge&logo=gradle&logoColor=white"> <img src="https://img.shields.io/badge/springboot-6DB33F?style=for-the-badge&logo=springboot&logoColor=white"/> <img src="https://img.shields.io/badge/mariaDB-003545?style=for-the-badge&logo=mariaDB&logoColor=white"/>

### [ Tool ]
<img src="https://img.shields.io/badge/figma-F24E1E?style=for-the-badge&logo=figma&logoColor=white"/> <img src= "https://img.shields.io/badge/Visual%20Studio%20Code-0078d7.svg?style=for-the-badge&logo=visual-studio-code&logoColor=white"> <img alt="IntelliJ" src="https://img.shields.io/badge/IntelliJ IDEA-%23FF9900?style=for-the-badge&logo=intellij idea&logoColor=white" /> <img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white"> ![Notion](https://img.shields.io/badge/Notion-%23000000.svg?style=for-the-badge&logo=notion&logoColor=white) <img alt="Discord" src="https://img.shields.io/badge/Discord-%235865F2.svg?style=for-the-badge&logo=discord&logoColor=white">

<br>

## 📑 요구사항 명세서
[요구사항 명세서](https://docs.google.com/spreadsheets/d/1TyRsbSeW4v-V-AyeoBwzd_29XmxtEqnAE0FZL05jrjU/edit?gid=960276421#gid=960276421)
<br><br>
![image](https://github.com/user-attachments/assets/e32b0cf2-7702-4d38-9e0a-07d426e88cde)
![image](https://github.com/user-attachments/assets/254d379b-7b84-476a-8277-394bdb8e9f98)
![image](https://github.com/user-attachments/assets/75cb110f-cb93-4a78-ad57-197bb92dac45)


<br>

## 📑 테이블 명세서
[테이블 명세서](https://docs.google.com/spreadsheets/d/1TyRsbSeW4v-V-AyeoBwzd_29XmxtEqnAE0FZL05jrjU/edit?gid=373256007#gid=373256007) 
<br><br>
![image](https://github.com/user-attachments/assets/6eb4ab10-2447-4313-b490-b61016f71e04)
![image](https://github.com/user-attachments/assets/3a491183-09f0-4455-97c7-7eabb61381e5)



<br>

## 📑 ERD
[ERD](https://www.erdcloud.com/d/5T9PHBo9HqThgb8QT)
<p align="center">
  <img alt="Erd" src="https://github.com/user-attachments/assets/869deee9-54ef-4243-95d0-13aa0b3fccfb">
</p>
<br>

## 📑 API 명세서
[API](https://docs.google.com/spreadsheets/d/1TyRsbSeW4v-V-AyeoBwzd_29XmxtEqnAE0FZL05jrjU/edit?gid=1243557912#gid=1243557912)
<br><br>
![image](https://github.com/user-attachments/assets/e784dc03-6182-4c68-b583-00a79a61b337)

<br>

## 📑 CI/CD 계획서
![system](https://github.com/user-attachments/assets/a6ef4aa1-4238-4715-b2da-ca0a8e6758cc)

```
1. 개발자가 코드를 작성 및 테스트한 후, 변경사항을 github로 push
2. 변경사항이 Git에 push 되면 Webhook이 이벤트를 감지하고 해당 이벤트를 처리하기 위해서 HTTP 요청
3. Webhook에서 JENKINS로 요청을 전송
	3-1. [Backend] 요청을 통해 Back pipeline이 동작하게 되고, Gradle 빌드하여 jar 파일을 생성
	3-2. [Frontend] 요청을 통해 Front pipeline이 동작하게 되고, npm 빌드를 통해 dist 폴더를 생성
4. 각 빌드 결과물은 Dockerfile를 사용하여 Docker image로 생성
5. 생성된 Docker image를 DockerHub로 push
6. 쿠버네티스 클러스터는 Docker image를 pull하고, 이를 각각의 Pod로 배포
	이 때, 각 Pod는 ReplicaSet으로 관리 됨
```

<br>

<details>
  <summary>backend pipeline</summary>

```
pipeline {
    agent {
        kubernetes {
            yaml '''
            apiVersion: v1
            kind: Pod
            metadata: 
              name: jenkins-agent
            spec:
              containers:
              - name: gradle
                image: gradle:8.10.0-jdk21
                command:
                - cat
                tty: true
              - name: docker
                image: docker:27.2.0-alpine3.20
                command:
                - cat
                tty: true
                volumeMounts:
                - mountPath: "/var/run/docker.sock"
                  name: docker-socket
              - name: kubectl
                image: gcr.io/cloud-builders/kubectl
                command:
                - cat
                tty: true
              volumes:
              - name: docker-socket
                hostPath:
                  path: "/var/run/docker.sock"
            '''
        }
    }

    environment {
        GIT_BRANCH = 'back'
        DOCKER_IMAGE_TAG = "${env.BUILD_NUMBER}"
        DISCORD_WEBHOOK = credentials('discord-webhook')
    }

    stages {
        stage('Checkout') {
            steps{
                git branch: "${GIT_BRANCH}", 
                    credentialsId: 'github_access_ssh_samdasu',
                    url: 'git@github.com:uzz99/Samdasu-Devops.git'
            }
        }

        stage('Build Backend') {
            when {
                changeset "devopsBackend/**"
            }
            steps {
                container('gradle'){
                    dir('devopsBackend') {
                        echo "Build devopsBackend Test"

                        sh 'chmod +x ./gradlew'
                        sh './gradlew clean build -x test'
                    }
                }
            }
        }

        stage('Docker Image Build'){
            when {
                changeset "devopsBackend/**"
            }
            steps {
                container('docker'){
                    script {
                        echo "DockerImageTag : ${DOCKER_IMAGE_TAG}"
                        echo "Docker Build Test"

                        sh 'docker logout'
                        withCredentials([usernamePassword(credentialsId: 'samdasu-dockerhub-access', 
                            usernameVariable: 'DOCKER_USERNAME', passwordVariable: 'DOCKER_PASSWORD' )]){
                                sh 'echo $DOCKER_PASSWORD | docker login -u $DOCKER_USERNAME --password-stdin'
                        }

                        dir('devopsBackend') {
                            withEnv(["DOCKER_IMAGE_TAG=${DOCKER_IMAGE_TAG}"]){
                                sh 'docker -v'
                                sh 'docker build --no-cache -t uzz99/samdasu_repo:fourstit-back-$DOCKER_IMAGE_TAG ./'
                                sh 'docker image inspect uzz99/samdasu_repo:fourstit-back-$DOCKER_IMAGE_TAG'
                                sh 'docker push uzz99/samdasu_repo:fourstit-back-$DOCKER_IMAGE_TAG'
                            }
                        }
                        sh 'docker logout'
                    }
                }
            }
        }

        stage('Deployment'){
            when {
                changeset "devopsBackend/**"
            }
            steps{
                container('kubectl'){
                    script {

                        echo "DockerImageTag : ${DOCKER_IMAGE_TAG}"
                        
                        withEnv(["DOCKER_IMAGE_TAG=${DOCKER_IMAGE_TAG}"]){
                            sh 'kubectl set image deploy fourstit-back-deploy fourstit-back=uzz99/samdasu_repo:fourstit-back-$DOCKER_IMAGE_TAG -n default'
                        }
                    }
                }
            }
        }
    }
    
    post {
        success {
            withCredentials([string(credentialsId: 'discord-webhook', variable: 'DISCORD')]) {
                discordSend description: """
                제목 : ${currentBuild.displayName}
                결과 : ${currentBuild.result}
                실행 시간 : ${currentBuild.duration / 1000}s
                Docker 이미지 태그 생성: fourstit-back-${DOCKER_IMAGE_TAG}
                """,
                result: currentBuild.currentResult,
                title: "${env.JOB_NAME} : ${currentBuild.displayName} 성공", 
                webhookURL: "${DISCORD}"
            }
        }

        failure {
            withCredentials([string(credentialsId: 'discord-webhook', variable: 'DISCORD')]) {
                discordSend description: """
                제목 : ${currentBuild.displayName}
                결과 : ${currentBuild.result}
                실행 시간 : ${currentBuild.duration / 1000}s
                """,
                result: currentBuild.currentResult,
                title: "${env.JOB_NAME} : ${currentBuild.displayName} 실패", 
                webhookURL: "${DISCORD}"
            }
        }
    }
}
```

</details>


<details>
  <summary>front pipeline</summary>

```
pipeline {
    agent {
        kubernetes {
            yaml '''
            apiVersion: v1
            kind: Pod
            metadata: 
              name: jenkins-agent
            spec:
              containers:
              - name: node
                image: node:18.20.4-alpine3.20
                command:
                - cat
                tty: true
              - name: docker
                image: docker:27.2.0-alpine3.20
                command:
                - cat
                tty: true
                volumeMounts:
                - mountPath: "/var/run/docker.sock"
                  name: docker-socket
              - name: kubectl
                image: gcr.io/cloud-builders/kubectl
                command:
                - cat
                tty: true
              volumes:
              - name: docker-socket
                hostPath:
                  path: "/var/run/docker.sock"
            '''
        }
    }

    environment {
        GIT_BRANCH = 'front'
        DOCKER_IMAGE_TAG = "${env.BUILD_NUMBER}"
        DISCORD_WEBHOOK = credentials('discord-webhook')
    }

    stages {
        stage('Checkout') {
            steps{
                git branch: "${GIT_BRANCH}", 
                    credentialsId: 'github_access_ssh_samdasu',
                    url: 'git@github.com:beyond-sw-camp/be08-4th-3Dasoo.git'
            }
        }

        stage('Npm install & Build Frontend') {
            when {
                changeset "devopsFront/**"
            }
            steps {
                container('node') {
                    dir('devopsFront') {
                        echo "Build devopsFront Test"
                        sh 'npm install'
                        sh 'npm run build'
                    }
                }
            }
        }

        stage('Docker Image Build') {
            when {
                changeset "devopsFront/**"
            }
            steps {
                container('docker') {
                    script {
                        echo "DockerImageTag : ${DOCKER_IMAGE_TAG}"
                        echo "Docker Build Test"

                        sh 'docker logout'
                        withCredentials([usernamePassword(credentialsId: 'samdasu-dockerhub-access', 
                            usernameVariable: 'DOCKER_USERNAME', passwordVariable: 'DOCKER_PASSWORD' )]){
                                sh 'echo $DOCKER_PASSWORD | docker login -u $DOCKER_USERNAME --password-stdin'
                        }

                        dir('devopsFront') {
                            withEnv(["DOCKER_IMAGE_TAG=${DOCKER_IMAGE_TAG}"]){
                                sh 'docker build --no-cache -t uzz99/samdasu_repo:fourstit-front-$DOCKER_IMAGE_TAG ./'
                                sh 'docker image inspect uzz99/samdasu_repo:fourstit-front-$DOCKER_IMAGE_TAG'
                                sh 'docker push uzz99/samdasu_repo:fourstit-front-$DOCKER_IMAGE_TAG'
                            }
                        }
                        sh 'docker logout'
                    }
                }
            }
        }
        stage('Deployment'){
            when {
                changeset "devopsFront/**"
            }
            steps{
                container('kubectl'){
                    script {
                        echo "DockerImageTag : ${DOCKER_IMAGE_TAG}"
                        
                        withEnv(["DOCKER_IMAGE_TAG=${DOCKER_IMAGE_TAG}"]){
                            sh 'kubectl set image deploy fourstit-front-deploy nginx=uzz99/samdasu_repo:fourstit-front-$DOCKER_IMAGE_TAG -n default'
                        }
                    }
                }
            }
        }
    }
    
    post {
        success {
            withCredentials([string(credentialsId: 'discord-webhook', variable: 'DISCORD')]) {
                discordSend description: """
                제목 : ${currentBuild.displayName}
                결과 : ${currentBuild.result}
                실행 시간 : ${currentBuild.duration / 1000}s
                관련 Docker 이미지 태그: fourstit-front-${DOCKER_IMAGE_TAG}
                """,
                result: currentBuild.currentResult,
                title: "${env.JOB_NAME} : ${currentBuild.displayName} 성공", 
                webhookURL: "${DISCORD}"
            }
        }

        failure {
            withCredentials([string(credentialsId: 'discord-webhook', variable: 'DISCORD')]) {
                discordSend description: """
                제목 : ${currentBuild.displayName}
                결과 : ${currentBuild.result}
                실행 시간 : ${currentBuild.duration / 1000}s
                """,
                result: currentBuild.currentResult,
                title: "${env.JOB_NAME} : ${currentBuild.displayName} 실패", 
                webhookURL: "${DISCORD}"
            }
        }
    }
}
```

</details>

<br>


## 📑 테스트 케이스
[테스트 케이스](https://docs.google.com/spreadsheets/d/1TyRsbSeW4v-V-AyeoBwzd_29XmxtEqnAE0FZL05jrjU/edit?gid=477064179#gid=477064179)
<br><br>
![image](https://github.com/user-attachments/assets/b088613f-a2d7-4e03-a3c2-f96d1ac9e7c3)
![image](https://github.com/user-attachments/assets/ae2ebf73-7a71-4269-baff-4c03fc56ed57)


<br>

## 📑 테스트

<details>
  <summary>(전)로고 타이틀</summary>
 
![image](https://github.com/user-attachments/assets/314a95a9-9cf1-44df-aff4-a2b253ab3fdd)
</details>

<details>
  <summary>도커 이미지 생성</summary>
 
![image](https://github.com/user-attachments/assets/9d00fe57-705e-4d88-88d6-0cd022eb43b8)
</details>

<details>
  <summary>도커 허브에 이미지 push</summary>
 
![image](https://github.com/user-attachments/assets/fad64940-509b-4d99-a5be-95c05380cbf4)
![image](https://github.com/user-attachments/assets/002dccd6-060f-460a-9be3-db484ea1bc74)

</details>

<details>
  <summary>(후)로고 타이틀 변화</summary>

![image](https://github.com/user-attachments/assets/2da54d09-56b5-424c-a0de-701f78e7d1a6)
</details>

<details>
  <summary>전체 파이프 라인</summary>
	
![image](https://github.com/user-attachments/assets/d1040bed-817b-4996-8992-55aaef264b00)

</details>


<br>

## 📆 WBS
[WBS](https://docs.google.com/spreadsheets/d/1YytUhICDiLV1lWI4rCTrFqUB8M-SIeyeQkFrIw2cKj0/edit?gid=0#gid=0)
<br><br>
![image](https://github.com/user-attachments/assets/a38a7716-68b9-451f-a462-38d5e0bf1fad)



<br>

## 📑 기타
[기사 출처](https://docs.google.com/spreadsheets/d/1TyRsbSeW4v-V-AyeoBwzd_29XmxtEqnAE0FZL05jrjU/edit?gid=379834428#gid=379834428)
<br><br>
![image](https://github.com/user-attachments/assets/697d4c2a-1b43-417f-87b9-67fdefb3c5c5)

<br>


## :memo: 회고
|&nbsp;&nbsp;팀&nbsp;원&nbsp;&nbsp;&nbsp;|회고록|
|:---:|---|
|장현준|이번 데브옵스 프로젝트를 하면서 도커, 쿠버네티스, 젠킨스를 처음 경험해보는 것이다 보니 git을 처음 경험했을 때처럼 익숙하지 않고 생각이상으로 어려웠다. 도커를 통해 이미지를 생성하고, 쿠버네티스를 이용하여 생성한 이미지를 바탕으로 deploy와 service를 생성하는 것 까지는 쉽게 이해했지만, 젠킨스를 통한 파이프라인을 구성하고 배포를 하는 과정이 어렵게 다가왔다. 하지만 팀원들과 서로 공부해가며 잘 이해했던 뜻 깊은 시간이었다.|
|김은경||
|이유진||
|이지정|데브옵스라는 것 자체가 처음이다 보니까 생소하고 어렵게 느껴졌었다. 물론 지금도 쉬운...건 아니지만 팀원들과 수업 내용을 토대로 한번씩 해보는 것을 목표를 가지고 공부를 한 덕분에 수업시간에 이해되지 않았던 내용들이 이해되었던 소중한 시간이었던 것 같다. 또한, 어려운 부분이나 오류 내용을 팀원들에게 말하면 팀원들이 많은 도움을 주어서 고생이 덜 했었다. 아직도 참 배울 것이 많고 공부해야 될 부분이 많은 것 같다.|
|정수진|데스옵스 정말 만만치 않은... 정말 어려웠지만 너무나 감사하게 팀원분들이 옆에서 도와주셔서 개인적으로 많이 배울 수 있는 시간이었습니다. 모든 팀원분들에게 감사드리고 앞으로 최종까지 열심히 화이팅이요! |
|최규범|데브옵스 프로젝트를 시작하며 처음엔 이미 다 완성되어 있는 프로젝트를 통합하고 배포하는 것이 크게 어렵겠나? 라는 생각을 진행했다가 정말 큰 벽을 느껴버린 그런 프로젝트였습니다. 그래도 한번이라도 이런 경험을 할 수 있어서 좋았고 앞으로 더 정진하겠습니다...그런 어렵고 힘든 상황을 팀원들 덕분에 해결해 나아갈 수 있어 팀원들에게 매우 감사와 영광을 돌립니다.|
<br>
